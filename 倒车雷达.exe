
概述:
本课题主要是设计一款基于超声波技术的倒车雷达系统. 超声波在空气中传播速度位340m/s,具有指向性强,传播衰耗低,传播距离远的特点.根据超声波的特性,我们可以实现对空间距离的测量: 在已知声音传播速度的前提下,通过测量声波反弹时间,即可得到两物体间距离.这种利用超声波测量距离的技术,具有快速,方便,抗干扰,成本低且精度高的优点. 所以日常生活中超声波测距具有广泛用途.而我们的超声波倒车雷达就是其中一例应用.
本设计采用STM32F103作为主控芯片,.

关键词  STM32  倒车雷达  超声波测距


前言:
在自然界中,最常见的超声波的应用就是蝙蝠的飞行测距.蝙蝠的蝙蝠的飞行就是靠其自身发出的超声波进行定位.蝙蝠从口中发出高频超声波,超声波遇到墙壁等障碍物反弹,蝙蝠的耳朵接收到超声波,经过蝙蝠大脑的运算,蝙蝠就可以知道障碍物的距离,从而可以在黑暗中自由飞翔.人类通过观察,研究蝙蝠的行为,也学会了使用超声波测距的技术.倒车雷达系统就是其中的一个应用.驾驶者在把车拨到R档的时候,汽车就会自动开启超声波测距模块,当驾驶者不慎将车开离预定车位,或者和障碍物靠的很近的时候,就会响起警报,提醒驾驶者注意安全.
近几年很火的自动驾驶技术,也可以利用超声波测距技术.在车的四周加上超声波测距模块,当车靠近障碍物时,汽车可以根据模块返回的结果进行自动调整,从而避开障碍物实现自动驾驶.超声波测距计数具有指向性强,传播衰耗低,传播距离远的特点,成本低廉而且精度高.




1. 超声波模块

2. 数码管显示电路

3. I2C以及EEPROM对报警参数数据的储存.

简介,
AT24CXX,是ATMAL公司推出的电可擦除只读存储器(EEPROM),主要通过I2C协议进行通信,输入
电压为1.8V-5V.

通信速率,
根据输入电压的大小来确定,在5V等级中,支持400KHz.而在1.8/2.5/2.7V电压等级中,则只能
支持100KHz的传输速率.

容量,
根据型号可以确定,AT24CXX,XX=XX KBit,例如我们常用的AT24C02,即2KBit(256Byte)

写保护,
如果只想把EEPROM的数据作为只读数据,可以将AT24CXX的WP脚拉高,这样AT24CXX就处于写保
护的状态中,此时外界只能读取EEPROM的数值,而无法修改

页写,
除了单个数据的传输外,AT24CXX还支持页写操作,可以一次写一页的数据.不同型号的"一页"的
大小都不一致的:1/2K内存的芯片,每8个字节为1页;而4/8/16K的芯片,16个字节为1页;32/64K
的32个字节为之一页.值得主要的是,如果"页写"操作中,写的数据数据超过当前"页",则最新的
数据会"环回"到当前"页"的页首,类似于一个长度为"页"的环形FIFO.

而无论是单字节的写操作还是以页为单位的页写操作,需要延时一定时间,让AT24CXX去将缓冲区
内的数据写入真正的EEPROM内部.在此期间,对AT24CXX的任何操作都无响应(NoAck).一个写周期
的时间最大为10MS.一般而言,在5V供电的情况下,5MS的延时时间是比较典型的值.

值得注意的是,AT24C02的读取函数在手册上并未描述但的确存在的一个限制: AT24C02(其他型号的尚未能验证)存在无法连续读大于256个字节数据的限制.如果连续读取大于256个字节的数据,在256个字节后读取出来的数据都为0xFF.为此,针对于这样的情况,我们需要将其分批读取.

值得注意的是, SL_Device_Control 函数要在 SL_I2C_BusDevieInit函数之后执行,因为在设备初始化函数执行之前,设备框架中的函数指针尚未和设备挂接,这样的情况下, SL_Device_Control 指向NULL,这时候无法将 I2C_BitOps 的指针正确地传递给BUS变量,当BUS变量调用 I2C_BitOps 的指针(野指针)时,会导致错误的指针跳转,从而让系统跑飞.....

时钟系统是整个系统中最重要的部分,时钟的跳动类似于人类的"心跳",为整个系统的运作提供了稳定充足的动力.

不同于51单片机只有一个时钟系统的情况,STM32具备多种而复杂的时钟系统,例如内核时钟总线
AHP,内部高速外设时钟总线APB2,内部低速外设时钟总线APB1等等.STM32由于其外设接口繁多,
不同的外设的运行速率都不尽一致,例如ADC的时钟是14M,USB的时钟是48M,GPIO的时钟是72M,基本
及通用定时器的时钟是36M,看门狗的时钟是1.25KHz等等.这导致其时钟系统非常复杂.由于避免高速
时钟所带来的不稳定性和高功耗的问题,除了必要的内核之外,STM32的外设时钟一般都是关闭的,在
必要的时候才会开启对应的时钟总线.值得注意的是,并不是所有的外设都是需要高速的时钟总线,例
如IWDG和RTC就仅仅需要几十KHz的时钟就可以了.在一个系统中,不考虑综合性能而一味追求高速,意味
不稳定和高能耗.因此,一个多时钟系统以适应不同外设需要的时钟系统尤为重要.
在STM32芯片中,具备有4个时钟源,分别是内部高速时钟(HSI),内部低速时钟(LSI),外部高速时钟(HSE),
外部低速时钟(LSE),低速时钟一般是提供给RTC或者是独立看门狗,高速时钟一般是通过PLL倍频给系统
内核以作为系统主时钟.其中,最大的倍频倍数是16倍,但是系统时钟具有72M上限限制,如果倍频超过了
这个限制,则为"超频",在这个状态下,并不能保证系统的任何性能是否得以实现.
















